<% content_for :title, "What's New" %>

<div class="min-h-screen bg-gray-50">
  <% unless native_app? %>
    <%= render 'shared/header' %>
  <% end %>

  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 <%= native_app? ? 'pt-4 pb-8' : 'py-8' %>">
    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center gap-3 mb-2">
        <div class="w-12 h-12 bg-gradient-to-br from-primary-500 to-secondary-600 rounded-xl flex items-center justify-center">
          <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
          </svg>
        </div>
        <div>
          <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">What's New</h1>
          <p class="text-gray-600">The latest features and improvements</p>
        </div>
      </div>

      <% if @unseen_ids.any? %>
        <%= button_to mark_all_seen_announcements_path, method: :post, class: "mt-4 text-sm text-primary-600 hover:text-primary-700 font-medium", data: { turbo: false } do %>
          Mark all as read
        <% end %>
      <% end %>
    </div>

    <!-- Announcements List -->
    <% if @announcements.any? %>
      <div class="space-y-6">
        <% @announcements.each do |announcement| %>
          <div class="bg-white rounded-xl shadow-lg overflow-hidden <%= @unseen_ids.include?(announcement.id) ? 'ring-2 ring-primary-500' : '' %>">
            <!-- Header with icon -->
            <div class="bg-gradient-to-r from-primary-500 to-secondary-600 px-6 py-4">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                    <%= render_announcement_icon(announcement.icon) %>
                  </div>
                  <div>
                    <h2 class="text-lg font-bold text-white"><%= announcement.title %></h2>
                    <% if announcement.version.present? %>
                      <span class="text-sm text-white/80">Version <%= announcement.version %></span>
                    <% end %>
                  </div>
                </div>
                <% if @unseen_ids.include?(announcement.id) %>
                  <span class="px-3 py-1 bg-white/20 text-white text-xs font-bold rounded-full">NEW</span>
                <% end %>
              </div>
            </div>

            <!-- Content -->
            <div class="px-6 py-5">
              <div class="text-gray-700 space-y-3 [&>ul]:list-disc [&>ul]:pl-5 [&>ul]:space-y-1">
                <%= sanitize(announcement.description, tags: %w[p strong em ul ol li br h3 h4]) %>
              </div>
              <div class="mt-4 text-xs text-gray-500">
                <%= announcement.published_at.strftime('%B %d, %Y') %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="bg-white rounded-xl shadow-lg p-12 text-center">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">No announcements yet</h3>
        <p class="text-gray-600">Check back later for updates!</p>
      </div>
    <% end %>
  </div>
</div>
